<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo Address Selector Component - Tích hợp MauBieu7202</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        body {
            background-color: #f8f9fa;
            padding: 20px;
        }
        .demo-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .output-section {
            background: #fff;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        .output-item {
            margin-bottom: 10px;
        }
        .output-label {
            font-weight: 600;
            color: #495057;
        }
        .output-value {
            color: #212529;
            background: #e9ecef;
            padding: 8px 12px;
            border-radius: 4px;
            display: inline-block;
            min-width: 200px;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin-top: 10px;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h2 class="mb-0"><i class="bi bi-geo-alt"></i> Demo Address Selector Component</h2>
                <small>Tích hợp vào MauBieu7202 (Django)</small>
            </div>

            <div class="card-body">
                <div class="alert alert-info">
                    <i class="bi bi-info-circle"></i>
                    <strong>Hướng dẫn:</strong> Chọn địa chỉ theo thứ tự Tỉnh → Huyện → Xã → Khóm.
                    Component sẽ tự động điền vào các field bên dưới.
                </div>

                <!-- ADDRESS SELECTOR COMPONENT -->
                <div id="address-container"></div>

                <!-- BUTTONS -->
                <div class="d-grid gap-2 d-md-flex mt-3">
                    <button class="btn btn-success" id="getValueBtn">
                        <i class="bi bi-clipboard-check"></i> Lấy giá trị
                    </button>
                    <button class="btn btn-warning" id="setValueBtn">
                        <i class="bi bi-pencil"></i> Set giá trị mẫu
                    </button>
                    <button class="btn btn-danger" id="resetBtn">
                        <i class="bi bi-arrow-counterclockwise"></i> Reset
                    </button>
                </div>
            </div>
        </div>

        <!-- OUTPUT SECTION -->
        <div class="output-section">
            <h4><i class="bi bi-code-square"></i> Kết quả (Output)</h4>
            <p class="text-muted">Các giá trị này sẽ được tự động điền vào form Django của bạn</p>

            <div class="output-item">
                <span class="output-label">Địa chỉ đầy đủ:</span>
                <div class="output-value" id="output-full"></div>
            </div>

            <div class="output-item">
                <span class="output-label">Tỉnh:</span>
                <div class="output-value" id="output-province"></div>
            </div>

            <div class="output-item">
                <span class="output-label">Huyện:</span>
                <div class="output-value" id="output-district"></div>
            </div>

            <div class="output-item">
                <span class="output-label">Xã:</span>
                <div class="output-value" id="output-ward"></div>
            </div>

            <div class="output-item">
                <span class="output-label">Khóm:</span>
                <div class="output-value" id="output-hamlet"></div>
            </div>
        </div>

        <!-- HIDDEN FIELDS DEMO (Như trong Django form) -->
        <div class="output-section">
            <h4><i class="bi bi-input-cursor"></i> Hidden Fields (Django Form)</h4>
            <p class="text-muted">Trong Django, các giá trị sẽ được submit qua hidden inputs</p>

            <form id="demoForm">
                <input type="hidden" name="province" id="hidden-province">
                <input type="hidden" name="district" id="hidden-district">
                <input type="hidden" name="ward" id="hidden-ward">
                <input type="hidden" name="hamlet" id="hidden-hamlet">
                <input type="hidden" name="full_address" id="hidden-full">
            </form>

            <div class="code-block">
                <code id="formData"></code>
            </div>
        </div>

        <!-- USAGE CODE -->
        <div class="output-section">
            <h4><i class="bi bi-file-code"></i> Code sử dụng</h4>

            <div class="code-block">
<code>// 1. Include component trong Django template
&lt;script src="{% static 'js/address_selector_component.js' %}"&gt;&lt;/script&gt;

// 2. Tạo container
&lt;div id="address-container"&gt;&lt;/div&gt;

// 3. Khởi tạo
const selector = new AddressSelector('#address-container', {
    dataUrl: '{% static 'data/dia_danh.json' %}',
    showKhom: true,
    autoFill: function(fullAddress, parts) {
        // Tự động điền vào form
        document.querySelector('[name="full_address"]').value = fullAddress;
        document.querySelector('[name="province"]').value = parts.province;
        document.querySelector('[name="district"]').value = parts.district;
        document.querySelector('[name="ward"]').value = parts.ward;
        document.querySelector('[name="hamlet"]').value = parts.hamlet;
    }
});
</code>
            </div>
        </div>
    </div>

    <!-- Component Script -->
    <script src="address_selector_component.js"></script>

    <script>
        // Initialize component
        const selector = new AddressSelector('#address-container', {
            dataUrl: 'dia_danh.json', // Path to JSON file
            showKhom: true,
            autoFill: function(fullAddress, parts) {
                // Update output display
                document.getElementById('output-full').textContent = fullAddress || '-';
                document.getElementById('output-province').textContent = parts.province || '-';
                document.getElementById('output-district').textContent = parts.district || '-';
                document.getElementById('output-ward').textContent = parts.ward || '-';
                document.getElementById('output-hamlet').textContent = parts.hamletWithPrefix || '-';

                // Update hidden fields
                document.getElementById('hidden-province').value = parts.province || '';
                document.getElementById('hidden-district').value = parts.district || '';
                document.getElementById('hidden-ward').value = parts.ward || '';
                document.getElementById('hidden-hamlet').value = parts.hamlet || '';
                document.getElementById('hidden-full').value = fullAddress || '';

                // Update form data display
                updateFormDataDisplay();
            },
            onLoad: function(instance) {
                console.log('Address Selector loaded successfully!', instance);
            }
        });

        // Button: Get Value
        document.getElementById('getValueBtn').addEventListener('click', function() {
            const value = selector.getValue();
            console.log('Current value:', value);

            alert(
                'Địa chỉ đầy đủ:\n' + value.fullAddress + '\n\n' +
                'Raw data:\n' + JSON.stringify(value.raw, null, 2) + '\n\n' +
                'Parts:\n' + JSON.stringify(value.parts, null, 2)
            );
        });

        // Button: Set Value
        document.getElementById('setValueBtn').addEventListener('click', function() {
            selector.setValue({
                tinh: 'Tỉnh Bạc Liêu',
                huyen: 'Thị xã Giá Rai',
                xa: 'Phường 1',
                khom: '1'
            });
        });

        // Button: Reset
        document.getElementById('resetBtn').addEventListener('click', function() {
            selector.reset();

            // Clear output
            document.getElementById('output-full').textContent = '-';
            document.getElementById('output-province').textContent = '-';
            document.getElementById('output-district').textContent = '-';
            document.getElementById('output-ward').textContent = '-';
            document.getElementById('output-hamlet').textContent = '-';

            updateFormDataDisplay();
        });

        // Update form data display
        function updateFormDataDisplay() {
            const formData = new FormData(document.getElementById('demoForm'));
            const data = {};
            formData.forEach((value, key) => {
                data[key] = value;
            });

            document.getElementById('formData').textContent = JSON.stringify(data, null, 2);
        }
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
